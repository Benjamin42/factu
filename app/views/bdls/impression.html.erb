<%= render :template => 'commons/_header' %>
<style>	
	p {
	  margin: 0 0 0;
	}	
</style>

<p id="notice">
	<%= notice %>
</p>

<div class="cartouche" >
	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span6">
				<div>
					<%= image_tag("logo.png") %>
				</div>
			</div>
			
			<div class="span6">
				<p>Soilly, le <%= DateTime.now.strftime('%d/%m/%Y') %></p>
				
				<br/>
				
				<%= @bdl.client.nom %><br/>
				<% if @bdl.client.nom_info != nil %>
					<%= @bdl.client.nom_info %><br/>
				<%end%>
				<% if @bdl.client.bat != nil %>
					<%= @bdl.client.bat %><br/>
				<%end%>
				<% if @bdl.client.num_voie != nil %>
					<%= @bdl.client.num_voie %><br/>
				<%end%>
				<% if @bdl.client.bp != nil %>
					<%= @bdl.client.bp %><br/>
				<%end%>
				<% if @bdl.client.ville != nil %>
					<%= @bdl.client.ville %><br/>
				<%end%>
				<% if @bdl.client.pays != nil %>
					<%= @bdl.client.pays %><br/>
				<%end%>
				
			</div>
		</div>
	</div>
	
	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span6">
				<p><%= Parameter.findByName("adresse_factu_rue") %></p>
				<p><%= Parameter.findByName("adresse_factu_cp_ville") %></p>
				<p>Tel - Fax : <%= Parameter.findByName("tel") %></p>
				<p><small><%= Parameter.findByName("num_rc") %></small></p>
				<p><small>N° SIRET <%= Parameter.findByName("num_siret") %></small></p>
				<p><small>Code T.V.A <%= Parameter.findByName("code_tva") %></small></p>
			</div>
			<div class="span6">
				<div class="">
					<b>Bon de livraison N° <%= @bdl.num_bdl %> C.R.D</b>
				</div>
			</div>
		</div>
	</div>
	<br/>
</div>

<div class="well">
	<p>
		<b>Numéro de BdL :</b>
		<%= @bdl.num_bdl %>
	</p>	
	<p>
		<b>Client:</b>
		<%= @bdl.client.nom %>
	</p>
	<p>
		<b>Date BdL : </b>
		<% if @bdl.date_bdl && @bdl.date_bdl != nil %>
			<%= @bdl.date_bdl.strftime('%d/%m/%Y') %>
		<% end %>	
	</p>
</div>

<table class="table table-bordered">

	<tr>
		<th class="center">Produit</th>
		<th class="center">Quantité</th>
		<% if @gift %>
			<th class="center">Quantité Offerte</th>
		<%end%>
		<th class="center">Prix Unitaire TTC</th>
	</tr>
	
	<% for produitCommande in @bdl.commande_produit %>
		<% if (produitCommande.qty != nil && produitCommande.qty > 0) || (produitCommande.qty_cadeau != nil && produitCommande.qty_cadeau > 0) %>
			<tr>
				<td><b><%= produitCommande.produit.label %></b></td>
				<td class="center"><%= produitCommande.qty %></td>
				<% if @gift %>
					<td class="center"><%= produitCommande.qty_cadeau %></td>
				<%end%>
				<td class="center"><%= produitCommande.tarif.prix_unitaire_ht %> &euro;</td>
			</tr>
		<% end %>
	<%end%>
	
	<tr>
		<% if @gift %>
			<td colspan="5">&nbsp;</td>
		<% else %>
			<td colspan="4">&nbsp;</td>
		<% end %>
	</tr>
	
	<tr>
		<th class="center">Service</th>
		<th class="center" colspan="<%= if @gift then 2 else 1 end %>">Description</th>
		<th class="center">Montant TTC</th>
	</tr>
	
	<% for serviceCommande in @bdl.commande_service %>
		<% if serviceCommande.montant != nil && serviceCommande.montant > 0 %>
			<td><%= serviceCommande.service.label %></td>
			<td colspan="<%= if @gift then 2 else 1 end %>"><%= serviceCommande.service.commentaire %></td>
			<td class="center"><%= serviceCommande.montant %> &euro;</td>
		<% end %>
	<% end %>
	
</table>

<div class="center button">
	<a href="#" class="btn btn-warning" onclick="window.print(); return false;" >Imprimer</a>
</div>
<br/>

<div class="center button">
	<%= link_to '< Back', bdls_path, class:"btn btn-inverse" %>
</div>

<div class="legal-footer">
	<p><small><%= Parameter.findByName "reglement1" %></small></p>
	<p><small><%= Parameter.findByName "reglement2" %></small></p>
	<p><small><%= Parameter.findByName "reglement3" %></small></p>
	<p><small><%= Parameter.findByName "reglement4" %></small></p>
	<p><small><%= Parameter.findByName "reglement5" %></small></p>
	
</div>
